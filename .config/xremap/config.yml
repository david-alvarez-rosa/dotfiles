modmap:
  - name: Global
    remap:
      CapsLock:
        held: Ctrl_R
        alone: Esc
        free_hold: true
      Enter:
        held: Ctrl_R
        alone: enter
        free_hold: true
      Tab:
        held: Win_L
        alone: tab
        free_hold: true
      Backspace:
        held: Win_L
        alone: Backspace
        free_hold: true

keymap:
  - name: Emacs
    application:
      not: [Emacs, St]
    remap:
      C-s: C-f
      C-b: { with_mark: left }
      C-f: { with_mark: right }
      C-p: { with_mark: up }
      C-n: { with_mark: down }
      M-b: { with_mark: C-left }
      M-f: { with_mark: C-right }
      C-a: { with_mark: home }
      C-e: { with_mark: end }
      M-v: { with_mark: pageup }
      C-v: { with_mark: pagedown }
      M-Shift-comma: { with_mark: C-home }
      M-Shift-dot: { with_mark: C-end }
      C-j: enter
      C-o: [enter, left]
      C-w: [C-x, { set_mark: false }]
      M-w: [C-c, { set_mark: false }]
      C-y: [C-v, { set_mark: false }]
      C-d: [delete, { set_mark: false }]
      M-d: [C-delete, { set_mark: false }]
      C-k: [Shift-end, C-x, { set_mark: false }]
      Alt-backspace: [C-backspace, {set_mark: false}]
      C-M-space: [C-Shift-right, {set_mark: true}]
      C-slash: [C-z, { set_mark: false }]
      C-Shift-ro: C-z
      C-space: { set_mark: true }
      # C-r: Shift-F3
      M-Shift-5: C-h
      C-g: [esc, { set_mark: false }]
      C-x:
        remap:
          h: [C-home, C-a, { set_mark: true }]
          C-f: C-o
          C-s: C-s
          k: C-f4
          C-c: C-q
          u: [C-z, { set_mark: false }]

  - name: Firefox
    application:
      only: firefox
    remap:
      C-Shift-p: C-Shift-p
      C-Shift-r: C-F5
      C-q: C-w
